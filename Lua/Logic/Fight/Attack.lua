require("Logic/Fight/Skill")
require("Logic/Fight/BaseAttackSkill")
require("Logic/Fight/BaseStatus")
require("Logic/Fight/Skills/HandFight")
require("Logic/Fight/Skills/ExitFight")
require("Logic/Fight/Skills/ExitFail")
require("Logic/Fight/Skills/EnterFight")
require("Logic/Fight/Skills/Catch")
require("Logic/Fight/Skills/Detect")
require("Logic/Fight/Skills/Espace")
require("Logic/Fight/Skills/Poor")
require("Logic/Fight/Skills/God")
require("Logic/Fight/Skills/Spell")
require("Logic/Fight/Skills/UseItem")
require("Logic/Fight/Skills/FallStone")
require("Logic/Fight/Skills/Boundary")
require("Logic/Fight/Skills/IceBound")
require("Logic/Fight/Skills/IceSword")
require("Logic/Fight/Skills/FlySand")
require("Logic/Fight/Skills/ThrowStone")
require("Logic/Fight/Skills/IceWall")
require("Logic/Fight/Skills/PureRiver")
require("Logic/Fight/Skills/HailStone")
require("Logic/Fight/Skills/Fountain")
require("Logic/Fight/Skills/FloodWater")
require("Logic/Fight/Skills/ArmyHorse")
require("Logic/Fight/Skills/Heal")
require("Logic/Fight/Skills/AddSp")
require("Logic/Fight/Skills/DisStatus")
require("Logic/Fight/Skills/BambooTrap")
require("Logic/Fight/Skills/Clump")
require("Logic/Fight/Skills/Revive")
require("Logic/Fight/Skills/DisIce")
require("Logic/Fight/Skills/FallWood")
require("Logic/Fight/Skills/RollStone")
require("Logic/Fight/Skills/Taishan")
require("Logic/Fight/Skills/Doom")
require("Logic/Fight/Skills/GrassTree")
require("Logic/Fight/Skills/WeightlessWave")
require("Logic/Fight/Skills/SpiritAxe")
require("Logic/Fight/Skills/ShootingStarShell")
require("Logic/Fight/Skills/ToothedBall")
require("Logic/Fight/Skills/GoldShield")
require("Logic/Fight/Skills/WarElephant")
require("Logic/Fight/Skills/GravelSeize")
require("Logic/Fight/Skills/GiantSnake")
require("Logic/Fight/Skills/EarthSword")
require("Logic/Fight/Skills/EarthShock")
require("Logic/Fight/Skills/ElephantsCrush")
require("Logic/Fight/Skills/HorizontalCrush")
require("Logic/Fight/Skills/Landslip")
require("Logic/Fight/Skills/SoulMirror")
require("Logic/Fight/Skills/FireBall")
require("Logic/Fight/Skills/DisBoundary")
require("Logic/Fight/Skills/Mirror")
require("Logic/Fight/Skills/WhirlWind")
require("Logic/Fight/Skills/Shrink")
require("Logic/Fight/Skills/Enlarge")
require("Logic/Fight/Skills/DoubleHit")
require("Logic/Fight/Skills/RandomHit")
require("Logic/Fight/Skills/PlantGarlic")
require("Logic/Fight/Skills/DriveWind")
require("Logic/Fight/Skills/Limpid")
require("Logic/Fight/Skills/CrazyWind")
require("Logic/Fight/Skills/Avoid")
require("Logic/Fight/Skills/Gale")
require("Logic/Fight/Skills/DizzyAtk")
require("Logic/Fight/Skills/Dividebody")
require("Logic/Fight/Skills/Vitalit")
require("Logic/Fight/Skills/LightningDestroy")
require("Logic/Fight/Skills/StormFlashingBall")
require("Logic/Fight/Skills/FlyingSword")
require("Logic/Fight/Skills/MountainThrow")
require("Logic/Fight/Skills/HealthDrawer")
require("Logic/Fight/Skills/FlashingStiffWind")
require("Logic/Fight/Skills/QuakeLightning")
require("Logic/Fight/Skills/WindFaster")
require("Logic/Fight/Skills/TransferAttack")
require("Logic/Fight/Skills/WindPressureBall")
require("Logic/Fight/Skills/Twister")
require("Logic/Fight/Skills/ShaowRepeated")
require("Logic/Fight/Skills/Invisible")
require("Logic/Fight/Skills/BestHit")
require("Logic/Fight/Skills/FireWheel")
require("Logic/Fight/Skills/EightFire")
require("Logic/Fight/Skills/BlazeSword")
require("Logic/Fight/Skills/Arrow")
require("Logic/Fight/Skills/BlazeFlame")
require("Logic/Fight/Skills/Rabid")
require("Logic/Fight/Skills/FlyFire")
require("Logic/Fight/Skills/ThreeFire")
require("Logic/Fight/Skills/Through")
require("Logic/Fight/Skills/Ablaze")
require("Logic/Fight/Skills/RagFire")
require("Logic/Fight/Skills/FWheel")
require("Logic/Fight/Skills/Beacon")
require("Logic/Fight/Skills/Trance")
require("Logic/Fight/Skills/LoudShout")
require("Logic/Fight/Skills/ShakeTake")
require("Logic/Fight/Skills/Chaos")
require("Logic/Fight/Skills/ExactShoot")
require("Logic/Fight/Skills/CrossingBlinkArrow")
require("Logic/Fight/Skills/ArrowOverSky")
require("Logic/Fight/Skills/SameHeart")
require("Logic/Fight/Skills/Inspire")
require("Logic/Fight/Skills/Poision")
require("Logic/Fight/Skills/Traitor")
require("Logic/Fight/Skills/Protect")
require("Logic/Fight/Skills/MagicProtect")
require("Logic/Fight/Skills/SuperPoision")
require("Logic/Fight/Skills/RepeatBoltCar")
require("Logic/Fight/Skills/DashCar")
require("Logic/Fight/Skills/KnifeCar")
require("Logic/Fight/Skills/BoltCar")
require("Logic/Fight/Skills/ThrowCar")
require("Logic/Fight/Skills/StrongArrowTower")
require("Logic/Fight/Skills/ArrowTower")
require("Logic/Fight/Skills/GodArrowTower")
require("Logic/Fight/Skills/Explode")
require("Logic/Fight/Skills/RockWall")
require("Logic/Fight/Skills/BrickWall")
require("Logic/Fight/Skills/BambooWall")
require("Logic/Fight/Skills/SwordBreath")
require("Logic/Fight/Skills/OutEnemy")
require("Logic/Fight/Skills/RedlotusFire")
require("Logic/Fight/Skills/RuptureSky")
require("Logic/Fight/Skills/ShakeMallet")
require("Logic/Fight/Skills/ColdAdularia")
require("Logic/Fight/Skills/BigRollStone")
require("Logic/Fight/Skills/CityWall")
require("Logic/Fight/Skills/BigThrowCar")
require("Logic/Fight/Skills/Wrath")
require("Logic/Fight/Skills/ThreeSidesIceSwords")
require("Logic/Fight/Skills/ViolentCattle")
require("Logic/Fight/Skills/BiteSpiritPoisonous")
require("Logic/Fight/Skills/RoastFlame")
require("Logic/Fight/Skills/Meteor")
require("Logic/Fight/Skills/BoxingOfSun")
require("Logic/Fight/Skills/PeachJust")
require("Logic/Fight/Skills/PhoenixRabid")
require("Logic/Fight/Skills/BeneAchillean")
require("Logic/Fight/Skills/PitySoldier")
require("Logic/Fight/Skills/SnakeEight")
require("Logic/Fight/Skills/BackThrust")
require("Logic/Fight/Skills/FireSickle")
require("Logic/Fight/Skills/ColdGorgeous")
require("Logic/Fight/Skills/MagicSwordWind")
require("Logic/Fight/Skills/MagicSwordWater")
require("Logic/Fight/Skills/LionSnap")
require("Logic/Fight/Skills/BravelyTwoGradation")
require("Logic/Fight/Skills/MagicSwordEarth")
require("Logic/Fight/Skills/DarkIncantation")
require("Logic/Fight/Skills/YellowScarfViolentWave")
require("Logic/Fight/Skills/YellowScarfAnger")
require("Logic/Fight/Skills/WindMove")
require("Logic/Fight/Skills/SwordHell")
require("Logic/Fight/Skills/BigBow")
require("Logic/Fight/Skills/HeavenDeadYellowSupersed")
require("Logic/Fight/Skills/KurningSword")
require("Logic/Fight/Skills/Phoenix1")
require("Logic/Fight/Skills/Phoenix2")
require("Logic/Fight/Skills/Phoenix3")
require("Logic/Fight/Skills/Rocky")
require("Logic/Fight/Skills/WaterGod")
require("Logic/Fight/Skills/Dragon")
require("Logic/Fight/Skills/Dis4Status")
require("Logic/Fight/Skills/Chaos4")
require("Logic/Fight/Skills/SweepClaw")
require("Logic/Fight/Skills/SweepClaw2")
require("Logic/Fight/Skills/LeftClaw")
require("Logic/Fight/Skills/TurtlePoison")
require("Logic/Fight/Skills/TurtleCast")
require("Logic/Fight/Skills/TurtleHand")
require("Logic/Fight/Skills/TurtleVitality")
require("Logic/Fight/Skills/TurtleDis6Status")
require("Logic/Fight/Skills/DragonHead")
require("Logic/Fight/Skills/TigerCast")
require("Logic/Fight/Skills/KillPill")
require("Logic/Fight/Skills/Tardy")
require("Logic/Fight/Skills/FreezePunch")
require("Logic/Fight/Skills/SuperRefillMana")
require("Logic/Fight/Skills/GodWater")
require("Logic/Fight/Skills/SuperDissolve")
require("Logic/Fight/Skills/DarkMind")
require("Logic/Fight/Skills/KnightStrike")
require("Logic/Fight/Skills/SkyIceStrike")
require("Logic/Fight/Skills/SkyFreezeStrike")
require("Logic/Fight/Skills/IceCircularSaw")
require("Logic/Fight/Skills/FreezeVigor")
require("Logic/Fight/Skills/SnowWintwer")
require("Logic/Fight/Skills/BrightMirror")
require("Logic/Fight/Skills/StatusRelease")
require("Logic/Fight/Skills/BodyMindHealth")
require("Logic/Fight/Skills/BombPunch")
require("Logic/Fight/Skills/MagmaBomb")
require("Logic/Fight/Skills/FireTwister")
require("Logic/Fight/Skills/ThunderFire")
require("Logic/Fight/Skills/SeaOfFire")
require("Logic/Fight/Skills/FireGodWrath")
require("Logic/Fight/Skills/BaseDargonStrike")
require("Logic/Fight/Skills/DargonKingStrike")
require("Logic/Fight/Skills/SunlightSword")
require("Logic/Fight/Skills/FireDragonSnap")
require("Logic/Fight/Skills/Fire3_4")
require("Logic/Fight/Skills/FireInferno")
require("Logic/Fight/Skills/FireAmulet")
require("Logic/Fight/Skills/WildFightSoul")
require("Logic/Fight/Skills/LightningStroke")
require("Logic/Fight/Skills/LightShield")
require("Logic/Fight/Skills/LightDisStatus")
require("Logic/Fight/Skills/LightHealth")
require("Logic/Fight/Skills/Glare")
require("Logic/Fight/Skills/LightThrow")
require("Logic/Fight/Skills/WTiger")
require("Logic/Fight/Skills/GoldAttack")
require("Logic/Fight/Skills/Cluster")
require("Logic/Fight/Skills/ThrowSkull")
require("Logic/Fight/Skills/Witchcraft")
require("Logic/Fight/Skills/Voodoo")
require("Logic/Fight/Skills/BlackRotaryCut")
require("Logic/Fight/Skills/DarkCut")
require("Logic/Fight/Skills/SwordSleeve")
require("Logic/Fight/Skills/Basaltic")
require("Logic/Fight/Skills/FlyWheel")
require("Logic/Fight/Skills/DizzyCut")
require("Logic/Fight/Skills/DarkFire")
require("Logic/Fight/Skills/AngryMind")
require("Logic/Fight/Skills/CrazySoul")
require("Logic/Fight/Skills/AngerShield")
require("Logic/Fight/Skills/WarStep")
require("Logic/Fight/Skills/MagicalShield")
require("Logic/Fight/Skills/TaiChiLightning")
require("Logic/Fight/Skills/Stool")
require("Logic/Fight/Skills/SKILL13036")
require("Logic/Fight/Skills/SKILL22021")
require("Logic/Fight/Skills/SKILL20051")
require("Logic/Fight/Skills/SKILL12041")
require("Logic/Fight/Skills/SKILL14060")
require("Logic/Fight/Skills/SKILL12043")
require("Logic/Fight/Skills/SKILL22042")
require("Logic/Fight/Skills/FlyFireRandom")
require("Logic/Fight/Skills/WindShotBall")
require("Logic/Fight/Skills/WindAssultBall")
require("Logic/Fight/Skills/HotGinger")
require("Logic/Fight/Skills/SoulCurse")
require("Logic/Fight/Skills/WaterSquad")
require("Logic/Fight/Skills/WaterGun")
require("Logic/Fight/Skills/PassiveSkill")
require("Logic/Fight/Skills/IceHammer")
require("Logic/Fight/Skills/PoisonShield")
require("Logic/Fight/Skills/SkyFlame")
require("Logic/Fight/Skills/DolphinGraud")
require("Logic/Fight/Skills/HolyWater")
require("Logic/Fight/Skills/Taunt")
require("Logic/Fight/Skills/BunCharge")
require("Logic/Fight/Skills/LavaLandslip")
require("Logic/Fight/Skills/DarkDragonCrescentSlash")
require("Logic/Fight/Skills/EmperorSeize")
require("Logic/Fight/Skills/LastLand")
require("Logic/Fight/Skills/OverlordSlash")
require("Logic/Fight/Skills/QuakeWater")
require("Logic/Fight/Skills/GodzillaBeam")
require("Logic/Fight/Skills/GodzillaPunch")
require("Logic/Fight/Skills/GodzillaEarthquake")
require("Logic/Fight/Skills/CrazyDragonSpell")
require("Logic/Fight/Skills/Ambush")
require("Logic/Fight/Skills/Waterspout")
require("Logic/Fight/Skills/ChanChan")
require("Logic/Fight/Skills/YiMuLightning")
require("Logic/Fight/Skills/IdelHalo")

Attack = {};
Attack.__index = Attack;

function Attack.EndOfLine()
  if LuaHelper.CheckDefine("DemoCode") then
    local people = 10;
    local gov = 2;
    
    for i = 1, gov do
      people  = people - i * 10
    end
    
    if people > 0 then
      return true
    else
      return false
    end
  end
end

function Attack.New(id)
  local self ={};
  setmetatable(self, Attack);
  self.humIdx = id;    
  self.skillId = 0;        --技能種類
  self.showKind = 1;    --顯示技能方式 1:舊SetLight 2:新SetLight
  self.disKind = {};    --Array[0~MaxLight] of Byte;  //030602J顯圖權:地身天
  self.lights = {};     --Array[0~MaxLight] of TLight;

  self.nowSkill = nil; --招式主體
  return self;
end

function Attack:Free()
  self:CloseSkill();
end

function Attack.EndOfLine1()
  if LuaHelper.CheckDefine("DemoCode") then
    local people = 10;
    local gov = 2;
    
    for i = 1, gov do
      people  = people - i * 10
    end
    
    if people > 0 then
      return true
    else
      return false
    end
  end
end

function Attack.EndOfLine2()
  if LuaHelper.CheckDefine("DemoCode") then
    local people = 10;
    local gov = 2;
    
    for i = 1, gov do
      people  = people - i * 10
    end
    
    if people > 0 then
      return true
    else
      return false
    end
  end
end

function Attack.EndOfLine3()
  if LuaHelper.CheckDefine("DemoCode") then
    local people = 10;
    local gov = 2;
    
    for i = 1, gov do
      people  = people - i * 10
    end
    
    if people > 0 then
      return true
    else
      return false
    end
  end
end

function Attack:CloseSkill()
  FightField.SetShake(false);
  self:StopAllLight()
  if self.nowSkill ~= nil then 
    local skill = self.nowSkill;
    self.nowSkill = nil;
    skill:Free();    
  end

  self.skillId = 0;
end

function Attack:CheckSkill() --boolean 檢查技能是否結束,若己達播放結束的條件,則呼叫CloseSKill關閉
  if self.nowSkill ~= nil then
    if self.nowSkill.isLightEnd ~= nil and self.nowSkill.isLightEnd then 
      return true;
    end
  end

  return false;
end

function Attack.EndOfLine4()
  if LuaHelper.CheckDefine("DemoCode") then
    local people = 10;
    local gov = 2;
    
    for i = 1, gov do
      people  = people - i * 10
    end
    
    if people > 0 then
      return true
    else
      return false
    end
  end
end

function Attack.EndOfLine5()
  if LuaHelper.CheckDefine("DemoCode") then
    local people = 10;
    local gov = 2;
    
    for i = 1, gov do
      people  = people - i * 10
    end
    
    if people > 0 then
      return true
    else
      return false
    end
  end
end

function Attack:SetKind(skillId, targetIdx, fightArea)
  if fightArea == nil then 
    fightArea = 0;
  end

  if self.nowSkill ~= nil then 
    self:CloseSkill(); --強制清除前一筆
  end
  self.skillId = skillId;
  local humIdx =  self.humIdx;
   
  if FightField.fightHum[humIdx] == nil then 
    logError(string.Concat("SetKind Fail humIdx:", humIdx, " skillKind:", skillKind));
    return;
  end
  local func = Attack.GetAttackNewFunction(skillId);
  self.nowSkill = func(humIdx, targetIdx, fightArea);
end

function Attack.GetAttackNewFunction(skillId)
  local skillTable = nil;
  local skillShowKind = nil;
  if skillId == ESkill_Kind.EnterFight then 
      skillTable = EnterFight
  elseif skillId == ESkill_Kind.ExitFight then 
    skillTable = ExitFight;
  elseif skillId == SK_HandFight then
    skillTable = HandFight;
  elseif skillId == 10001 then     --落石
    skillTable = FallStone;
  elseif skillId == 10002 then     --擂木
    skillTable = FallWood;
  elseif skillId == 10003 then     --陷阱
    skillTable = BambooTrap;
  elseif skillId == 10004 then     --樹精
    skillTable = Clump;
  elseif skillId == 10005 then     --投石
    skillTable = ThrowStone;
  elseif skillId == 10006 then     --草木皆兵  地爪
    skillTable = GrassTree;
  elseif skillId == 10007 then     --滾石
    skillTable = RollStone;
  elseif skillId == 10008 then     --飛沙走石    
    skillTable = FlySand;
  elseif skillId == 10009 then     --解結界
    skillTable = DisBoundary;
  elseif skillId == 10010 then     --結界
    skillTable = Boundary;
  elseif skillId == 10011 then     --泰山
    skillTable = Taishan; 
  elseif skillId == 10012 then     --天崩地裂
    skillTable = Doom;
    skillShowKind = ESkill_Kind.Doom;
  elseif skillId == 10013 then     --萬馬奔騰
    skillTable = ArmyHorse;
  elseif skillId == 10014 then     --解鏡
    skillTable = DisMirror;
  elseif skillId == 10015 then     --鏡
    skillTable = Mirror;
  elseif skillId == 10016 then     --小岩獸
    skillTable = Rocky3; 
  elseif skillId == 10017 then     --小中岩獸
    skillTable = Rocky2; 
  elseif skillId == 10018 then     --中岩獸
    skillTable = Rocky2; 
  elseif skillId == 10019 then     --大岩獸
    skillTable = Rocky1;
  elseif skillId == 10021 then     --地裂無雙劍
    skillTable = EarthSword;
  elseif skillId == 10022 then     --地動破
    skillTable = EarthShock;
  elseif skillId == 10023 then     --驅象突
    skillTable = ElephantsCrush;
  elseif skillId == 10024 then     --橫掃千軍
    skillTable = HorizontalCrush;
  elseif skillId == 10025 then     --土崩陣
    skillTable = Landslip;
  elseif skillId == 10026 then     --靈鏡
    skillTable = SoulMirror;    
  elseif skillId == 10027 then     --無間震波
    skillTable = WeightlessWave;
  elseif skillId == 10028 then     --割天裂魂斧
    skillTable = SpiritAxe;
  elseif skillId == 10029 then     --流星鐵砲
    skillTable = ShootingStarShell;
  elseif skillId == 10030 then     --狼星砲
    skillTable = ToothedBall;
  elseif skillId == 10031 then     --金鐘罩
    skillTable = GoldShield;
  elseif skillId == 10032 then     --戰象衝鋒
    skillTable = WarElephant;    
  elseif skillId == 10033 then     --砂瀑擒
    skillTable = GravelSeize;
  elseif skillId == 10034 then     --黑屠岩王殺
    skillTable = GiantSnake;    
  elseif skillId == 10037 then     --地牙叢生
    skillTable = GrassTree3;
  elseif skillId == 10038 then     --萬華鏡
    skillTable = Mirror2;
  elseif skillId == 10039 then     --專武強化 鏡
    skillTable = EW_Mirror;
  elseif skillId == 10040 then     --專武強化 靈鏡
    skillTable = EW_SoulMirror;
  elseif skillId == 10041 then     --專武強化 結界
    skillTable = EW_Boundary;
  elseif skillId == 10042 then     --有客來
    skillTable = Taunt;
  elseif skillId == 10043 then     --爆漿流沙
    skillTable = LavaLandslip;
  elseif skillId == 10045 then    --仁巴無敵
    skillTable = EW_Doom;
    skillShowKind = ESkill_Kind.StarDoom;
  elseif skillId == 11001 then     --淹水  
    skillTable = Flood; 
  elseif skillId == 11002 then     --冰牆  
    skillTable = IceWall;
    skillShowKind = ESkill_Kind.IceWall;
  elseif skillId == 11003 then     --冰劍  
    skillTable = IceSword;
    skillShowKind = ESkill_Kind.IceSword;
  elseif skillId == 11004 then     --清流  
    skillTable = PureRiver;
  elseif skillId == 11005 then     --湧泉  
    skillTable = Fountain;
  elseif skillId == 11006 then     --回魔  
    skillTable = AddSp;
  elseif skillId == 11007 then     --治療  
    skillTable = Heal;
  elseif skillId == 11008 then     --洪水  
    skillTable = FloodWater;
  elseif skillId == 11009 then     --030605J全回魔  
    skillTable = AllAddSp;
  elseif skillId == 11010 then     --030605J全治療  
    skillTable = AllHeal;
  elseif skillId == 11011 then     --冰雹  
    skillTable = HailStone;
  elseif skillId == 11012 then     --030605J狀態解除
    skillTable = DisStatus;
  elseif skillId == 11013 then     --030605J復活
    skillTable = Revive;
  elseif skillId == 11014 then     --冰封
    skillTable = IceBound;
  elseif skillId == 11015 then     --030605J融冰封
    skillTable = DisIce;
  elseif skillId == 11016 then     --小水神
    skillTable = WaterGod3; 
  elseif skillId == 11017 then     --小中水神
    skillTable = WaterGod2;
  elseif skillId == 11018 then     --中水神
    skillTable = WaterGod2
  elseif skillId == 11019 then     --大水神
    skillTable = WaterGod1;
  elseif skillId == 11021 then     --冰旋斬
    skillTable = IceCircularSaw;
    skillShowKind = ESkill_Kind.IceCircularSaw;
  elseif skillId == 11022 then     --冰魄錐
    skillTable = FreezeVigor;
  elseif skillId == 11023 then     --霜寒凍裂
    skillTable = SnowWintwer;
  elseif skillId == 11024 then     --明鏡止水
    skillTable = BrightMirror;
  elseif skillId == 11025 then     --進階狀解
    skillTable = StatusRelease;
  elseif skillId == 11026 then     --妙手回春
    skillTable = BodyMindHealth;
  elseif skillId == 11027 then     --天迴冰舞
    skillTable = SkyFreezeStrike;
  elseif skillId == 11028 then     --霜雷拳
    skillTable = FreezePunch;
  elseif skillId == 11029 then     --超回魔術
    skillTable = SuperRefillMana;
  elseif skillId == 11030 then     --天降甘霖
    skillTable = GodWater;
  
    --[[
   Now Abraham was old and far on in years: and the Lord had given him everything in full measure.
   And Abraham said to his chief servant, the manager of all his property, Come now, put your hand under my leg:
   And take an oath by the Lord, the God of heaven and the God of the earth, that you will not get a wife for my son Isaac from the daughters of the Canaanites among whom I am living;
   But that you will go into my country and to my relations and get a wife there for my son Isaac.
   And the servant said, If by chance the woman will not come with me into this land, am I to take your son back again to the land from which you came?
   And Abraham said, Take care that you do not let my son go back to that land.
   The Lord God of heaven, who took me from my father's house and from the land of my birth, and made an oath to me, saying, To your seed I will give this land: he will send his angel before you and give you a wife for my son in that land.
   And if the woman will not come with you, then you are free from this oath; only do not take my son back there.
   And the servant put his hand under Abraham's leg, and gave him his oath about this thing.
   And the servant took ten of his master's camels, and all sorts of good things of his master's, and went to Mesopotamia, to the town of Nahor.
   And he made the camels take their rest outside the town by the water-spring in the evening, at the time when the women came to get water.
   And he said, O Lord, the God of my master Abraham, let me do well in what I have undertaken this day, and give your mercy to my master Abraham.
   See, I am waiting here by the water-spring; and the daughters of the town are coming out to get water:
   Now, may the girl to whom I say, Let down your vessel and give me a drink, and who says in answer, Here is a drink for you and let me give water to your camels: may she be the one marked out by you for your servant Isaac: so may I be certain that you have been good to my master Abraham.
   And even before his words were ended, Rebekah, the daughter of Bethuel, the son of Milcah, who was the wife of Nahor, Abraham's brother, came out with her water-vessel on her arm.
   She was a very beautiful girl, a virgin, who had never been touched by a man: and she went down to the spring to get water in her vessel.
   And the servant came running to her and said, Give me a little water from your vessel.
   And she said, Take a drink, my lord: and quickly letting down her vessel onto her hand, she gave him a drink.
   And having done so, she said, I will get water for your camels till they have had enough.
   And after putting the water from her vessel into the animals' drinking-place, she went quickly back to the spring and got water for all the camels.
   And the man, looking at her, said nothing, waiting to see if the Lord had given his journey a good outcome.
   And when the camels had had enough, the man took a gold nose-ring, half a shekel in weight, and two ornaments for her arms of ten shekels weight of gold;
   And said to her, Whose daughter are you? is there room in your father's house for us?
   And she said to him, I am the daughter of Bethuel, the son of Milcah, Nahor's wife.
   And she said, We have a great store of dry grass and cattle-food, and there is room for you.
   And with bent head the man gave worship to the Lord;
   And said, Praise be to the Lord, the God of my master Abraham, who has given a sign that he is good and true to my master, by guiding me straight to the house of my master's family.
   ]]--
  elseif skillId == 11031 then     --超狀解術
    skillTable = SuperDissolve;
  elseif skillId == 11032 then     --冥河無想
    skillTable = DarkMind;
  elseif skillId == 11033 then     --斬騎凜一閃
    skillTable = KnightStrike;
  elseif skillId == 11034 then     --六迴天冰舞
    skillTable = SkyIceStrike;
  elseif skillId == 11037 then     --噴水廣場
    skillTable = WaterSquad;
  elseif skillId == 11038 then     --水槍
    skillTable = WaterGun;
  elseif skillId == 11039 then     --專武冰封
    skillTable = EW_IceBound;
  elseif skillId == 11040 then     --專武進階狀解
    skillTable = EW_StatusRelease;
  elseif skillId == 11041  then    --斬騎凜一閃
    skillTable = EW_KnightStrike;
  elseif skillId == 11042 then     --天水之滴
    skillTable = HolyWater;
  elseif skillId == 11044 then     --三面埋伏
    skillTable = QuakeWater;
  elseif skillId == 11045 then    --遲鈍冰劍
    skillTable = IceSword;
    skillShowKind = ESkill_Kind.EW_SlowIceSword;
  elseif skillId == 11046 then    --混亂冰劍
    skillTable = IceSword;
    skillShowKind = ESkill_Kind.EW_ChaosIceSword;
  elseif skillId == 11048 then     --冰矢術
    skillTable = Arrow;
    skillShowKind = ESkill_Kind.IceArrow;
  elseif skillId == 12001 then     --縱火
    skillTable = Ablaze;
  elseif skillId == 12002 then     --烈火
    skillTable = RagFire;
  elseif skillId == 12003 then     --火箭
    skillTable = Arrow;
    skillShowKind = ESkill_Kind.FireArrow;
  elseif skillId == 12004 then     --火球
    skillTable = FireBall;
    skillShowKind = EFireBallKind.A;
  elseif skillId == 12005 then     --火輪
    skillTable = FWheel;
  elseif skillId == 12006 then     --會心一擊
    skillTable = BestHit;
  elseif skillId == 12007 then     --炎之舞
    skillTable = FireBall;
    skillShowKind = EFireBallKind.B;
  elseif skillId == 12008 then     --風火輪
    skillTable = FireWheel;
  elseif skillId == 12009 then     --030603J飛焰劍
    skillTable = FlyFire;
  elseif skillId == 12010 then     --烈燄極轟
    skillTable = BlazeFlame;
  elseif skillId == 12011 then     --八面火輪
    skillTable = EightFire;
  elseif skillId == 12012 then     --030602J 狂炎斬
    skillTable = Rabid;
  elseif skillId == 12013 then     --030602J 三昧真火
    skillTable = ThreeFire;
  elseif skillId == 12014 then     --030605J 烽火燎原
    skillTable = Beacon;
  elseif skillId == 12015 then     --030602J 白虹貫日
    skillTable = Through;
  elseif skillId == 12016 then     --小鳳
    skillTable = Phoenix3;
  elseif skillId == 12017 then     --小中鳳
    skillTable = Phoenix2;
  elseif skillId == 12018 then     --中鳳
    skillTable = Phoenix2;
  elseif skillId == 12019 then     --大鳳
    skillTable = Phoenix1;
  elseif skillId == 12021 then     --殛陽劍
    skillTable = SunlightSword;
    --[[
    Now in the days of Amraphel, king of Shinar, Arioch, king of Ellasar, Chedorlaomer, king of Elam, and Tidal, king of Goiim,
    They made war with Bera, king of Sodom, and with Birsha, king of Gomorrah, Shinab, king of Admah, and Shemeber, king of Zeboiim, and the king of Bela (which is Zoar).
    All these came together in the valley of Siddim (which is the Salt Sea).
    For twelve years they were under the rule of Chedorlaomer, but in the thirteenth year they put off his control.
    And in the fourteenth year, Chedorlaomer and the kings who were on his side, overcame the Rephaim in Ashteroth-karnaim, and the Zuzim in Ham, and the Emim in Shaveh-kiriathaim,
    And the Horites in their mountain Seir, driving them as far as El-paran, which is near the waste land.
    Then they came back to En-mishpat (which is Kadesh), making waste all the country of the Amalekites and of the Amorites living in Hazazon-tamar.
    And the king of Sodom with the king of Gomorrah and the king of Admah and the king of Zeboiim and the king of Bela (that is Zoar), went out, and put their forces in position in the valley of Siddim,
    Against Chedorlaomer, king of Elam, and Tidal, king of Goiim, and Amraphel, king of Shinar, and Arioch, king of Ellasar: four kings against the five.
    Now the valley of Siddim was full of holes of sticky earth; and the kings of Sodom and Gomorrah were put to flight and came to their end there, but the rest got away to the mountain.
    And the four kings took all the goods and food from Sodom and Gomorrah and went on their way.
    And in addition they took Lot, Abram's brother's son, who was living in Sodom, and all his goods.
    And one who had got away from the fight came and gave word of it to Abram the Hebrew, who was living by the holy tree of Mamre, the Amorite, the brother of Eshcol and Aner, who were friends of Abram.
    And Abram, hearing that his brother's son had been made a prisoner, took a band of his trained men, three hundred and eighteen of them, sons of his house, and went after them as far as Dan.
    --]]
  elseif skillId == 12022 then     --狂龍噬日
    skillTable = FireDragonSnap;
  elseif skillId == 12023 then     --熾燄無二
    skillTable = FireInferno;    
  elseif skillId == 12024 then     --丹陽護體
    skillTable = FireAmulet;
  elseif Contains(skillId, 12025, 12045) then     --狂熱戰魂
    skillTable = WildFightSoul;
  elseif skillId == 12026 then     --五雷轟頂
    skillTable = LightningStroke;
  elseif skillId == 12027 then     --火爆一擊
    skillTable = BombPunch;
  elseif skillId == 12028 then     --烈術豪火
    skillTable = MagmaBomb;
  elseif skillId == 12029 then     --赤龍炬
    skillTable = FireTwister;
  elseif skillId == 12030 then     --雷火召臨
    skillTable = ThunderFire;
  elseif skillId == 12031 then     --陽炎
    skillTable = SeaOfFire;
  elseif skillId == 12032 then     --祝融焚野
    skillTable = FireGodWrath;
  elseif skillId == 12033 then     --爵龍霸烈斬
    skillTable = DargonStrike;
  elseif skillId == 12034 then     --龍王震兮
    skillTable = DargonKingStrike;
  elseif skillId == 12037 then     --真。爵龍霸烈斬
    skillTable = NewDargonStrike;
  elseif skillId == 12038 or skillId == 12039 then     --大聖斬妖、大聖斬妖奧義      Alen 20160420
    skillTable = SKILL12038;
  elseif skillId == 12040 then     --金睛火眼
    skillTable = Arrow;
    skillShowKind = ESkill_Kind.SKILL12040;
  elseif skillId == 12041 or skillId == 12042 then  --12041蛇矛魂噬擊 12042蛇矛魂噬擊奧義
    skillTable = SKILL12041;
  elseif skillId == 12043 or skillId == 12044 then  --12043白虎藏地噬  12044白虎藏地噬奧義
    skillTable = SKILL12043;   
  elseif skillId == 12046 then     --專武五雷轟頂
    skillTable = EW_LightningStroke;
  elseif skillId == 12047 then     --專武狂龍噬日
    skillTable = EW_FireDragonSnap;
  elseif skillId == 12048 then     --專武無二
    skillTable = EW_FireInferno;
  elseif skillId == 12049 then     --專武火箭
    skillTable = Arrow;
    skillShowKind = ESkill_Kind.EW_FireArrow;
  elseif skillId == 12050 then     --專武震火
    skillTable = EW_QuakeFire;
  elseif skillId == 12051 then     --專武陽炎
    skillTable = EW_SeaOfFire;
  elseif skillId == 12052 then     --專武式鬼吸魂
    skillTable = EW_HealthDrawer;
  elseif skillId == 12054 then
    skillTable = Arrow;
    skillShowKind = ESkill_Kind.SKILL12054;
  elseif skillId == 13001 then     --御風術
    skillTable = DriveWind;
  elseif Contains(skillId ,13002, 13052) then     --旋風,旋風卡
    skillTable = WhirlWind;
  elseif skillId == 13003 then     --閃躲
    skillTable = Avoid;
  elseif skillId == 13004 then     --狂風
    skillTable = CrazyWind;
  elseif Contains(skillId, 13005, 13049) then     --隱身, 棒棒
    skillTable = Limpid;
  elseif skillId == 13006 then     --暴風
    skillTable = Gale;
  elseif skillId == 13007 then     --暈擊
    skillTable = DizzyAtk;    
  elseif Contains(skillId, 13008, 13032) then     --分身術,隱分身
    skillTable = Dividebody;
  elseif skillId == 13009 then     --風捲殘雲(種蒜)
    skillTable = PlantGarlic;
  elseif Contains(skillId, 13010, 14098) then     --連擊,連擊卡
    skillTable = DoubleHit;
  elseif skillId == 13011 then     --縮小
    skillTable = Shrink;
  
    --[[
    Now Dinah, the daughter whom Leah had by Jacob, went out to see the women of that country.
    And when Shechem, the son of Hamor the Hivite who was the chief of that land, saw her, he took her by force and had connection with her.
    Then his heart went out in love to Dinah, the daughter of Jacob, and he said comforting words to her.
    And Shechem said to Hamor, his father, Get me this girl for my wife.
    Now Jacob had word of what Shechem had done to his daughter; but his sons were in the fields with the cattle, and Jacob said nothing till they came.
    Then Hamor, the father of Shechem, came out to have a talk with Jacob.
    Now the sons of Jacob came in from the fields when they had news of it, and they were wounded and very angry because of the shame he had done in Israel by having connection with Jacob's daughter; and they said, Such a thing is not to be done.
    But Hamor said to them, Shechem, my son, is full of desire for your daughter: will you then give her to him for a wife?
    And let our two peoples be joined together; give your daughters to us, and take our daughters for yourselves.
    Go on living with us, and the country will be open to you; do trade and get property there.
    And Shechem said to her father and her brothers, If you will give ear to my request, whatever you say I will give to you.
    However great you make the bride-price and payment, I will give it; only let me have the girl for my wife.
    But the sons of Jacob gave a false answer to Shechem and Hamor his father, because of what had been done to Dinah their sister.
    And they said, It is not possible for us to give our sister to one who is without circumcision, for that would be a cause of shame to us:
    But on this condition only will we come to an agreement with you: if every male among you becomes like us and undergoes circumcision;
    Then we will give our daughters to you and take your daughters to us and go on living with you as one people.
    But if you will not undergo circumcision as we say, then we will take our daughter and go.
    And their words were pleasing to Hamor and his son Shechem.
    And without loss of time the young man did as they said, because he had delight in Jacob's daughter, and he was the noblest of his father's house.
    --]]
  elseif skillId == 13012 then     --放大
    skillTable = Enlarge;
  elseif skillId == 13013 then     --亂擊
    skillTable = RandomHit;
  elseif skillId == 13014 then     --元氣
    skillTable = Vitalit;
  elseif skillId == 13015 then     --小龍
    skillTable = Dragon3;
    skillShowKind = ESkill_Kind.Dragon3;
  elseif skillId == 13016 then     --小中龍
    skillTable = Dragon2;
  elseif skillId == 13017 then     --中龍
    skillTable = Dragon2;
  elseif skillId == 13018 then     --大龍
    skillTable = Dragon1;
  elseif skillId == 13020 then     --風之戰意
    skillTable = WindFaster;
  elseif skillId == 13021 then     --斗轉星移
    skillTable = TransferAttack;
  elseif skillId == 13022 then     --裂風彈
    skillTable = WindPressureBall;
  elseif skillId == 13023 then     --龍捲颶風
    skillTable = Twister;
  elseif skillId == 13024 then     --幻影連擊
    skillTable = ShaowRepeated;
  elseif skillId == 13025 then     --無形無相
    skillTable = Invisible;
  elseif skillId == 13026 then     --崩雷
    skillTable = LightningDestroy;
  elseif skillId == 13027 then     --風眩神離
    skillTable = StormFlashingBall;
  elseif skillId == 13028 then     --斬騎飛劍
    skillTable = FlyingSword;
  elseif skillId == 13029 then     --山嵐
    skillTable = MountainThrow;
  elseif skillId == 13030 then     --式鬼吸魂
    skillTable = HealthDrawer;
  elseif skillId == 13031 then     --風擎雷鳴
    skillTable = FlashingStiffWind;
  elseif skillId == 13033 then     --震電
    skillTable = QuakeLightning;
  elseif skillId == 13036 then     --青龍偃月斬、真．青龍偃月斬
    skillTable = SKILL13036;
  elseif skillId == 13038 then     --裂風散彈
    skillTable = WindShotBall;
  elseif skillId == 13039 then     --裂風連彈
    skillTable = WindAssultBall;
  elseif skillId == 13040 then     --專武縮小
    skillTable = EW_Shrink;
  elseif skillId == 13041 then     --專武暈擊
    skillTable = EW_DizzyAtk;
  elseif skillId == 13042 then     --專武隱身
    skillTable = EW_Limpid;
  elseif skillId == 13043 then     --專武震電
    skillTable = EW_QuakeLightning;
  elseif skillId == 13044 then     --肉包衝鋒
    skillTable = BunCharge;
  elseif skillId == 13046 then    --無盡風暴
    skillTable = WhirlWind6;
  elseif skillId == 13047 then    --醬醬
    skillTable = ChanChan;
  elseif skillId == 13048 then    -- 一支一支
    skillTable = BiteSpiritPoisonous;
    skillShowKind = ESkill_Kind.ChikiChiki;
  elseif skillId == 13050 then    --開派對囉
    skillTable = WhirlWindParty;
  elseif skillId == 13051 then  --巴龍風障
    skillTable = DragonTransfer;
  elseif skillId == 14001 then     --偵查
    skillTable = Detect;
  elseif skillId == 14002 then     --遁逃術
    skillTable = Espace;
  elseif skillId == 14008 then     --昏睡
    skillTable = Trance;
  elseif skillId == 14006 then     --大喝
    skillTable = LoudShout;
    skillShowKind = ESkill_Kind.LoudShout;
  elseif skillId == 14007 then     --解昏睡
    skillTable = DisTrance;
  elseif skillId == 14012 then     --同心
    skillTable = SameHeart;
  elseif skillId == 14013 then     --鼓舞
    skillTable = Inspire;
  elseif skillId == 14014 then     --解毒
    skillTable = DisPoision;
  elseif skillId == 14015 then     --施毒
    skillTable = Poision;
  elseif skillId == 14020 then     --內鬨
    skillTable = Traitor;
  elseif skillId == 14021 then     --混亂
    skillTable = Chaos;  
  elseif skillId == 14022 then     --解混亂
    skillTable = DisChaos;
  elseif skillId == 14029 then     --吉普賽1
    skillTable = Stool1;
  elseif skillId == 14030 then     --吉普賽2
    skillTable = Stool2;
  elseif skillId == 14033 then     --穿心瞬矢
    skillTable = CrossingBlinkArrow;
    skillShowKind = ESkill_Kind.CrossingBlinkArrow;
  elseif skillId == 14036 then     --百步穿揚
    skillTable = ExactShoot;
  elseif skillId == 14037 then     --箭舞九天
    skillTable = ArrowOverSky;
  elseif skillId == 14040 then     --霸意
    skillTable = AngryMind;
  elseif Contains(skillId, 14042, 14099) then     --怒濤戰踏, 怒濤戰踏卡
    skillTable = WarStep;
  elseif skillId == 14044 then     --天降神盾
    skillTable = MagicalShield;
  elseif skillId == 14046 then     --凝氣護盾
    skillTable = AngerShield;
  elseif skillId == 14053 then     --聖靈暴衝
    skillTable = CrazySoul;
  elseif skillId == 14054 then     --乾坤天雷
    skillTable = TaiChiLightning;
  elseif skillId == 14056 then     --魔法護身
    skillTable = MagicProtect;
  elseif skillId == 14057 then     --殺生
    skillTable = KillPill;
  elseif skillId == 14060 then     --全體天雷
    skillTable = SKILL14060;
  elseif skillId == 14062 then    --蝕魂詛咒
    skillTable = SoulCurse;
  elseif skillId == 14063 then    --專武大喝
    skillTable = EW_LoudShout;
    skillShowKind = ESkill_Kind.LoudShout;
  elseif skillId == 14064 then    --專武百步
    skillTable = EW_ExactShoot;
  elseif skillId == 14065 then    --專武混亂
    skillTable = EW_Chaos;
  elseif skillId == 15001 then    --捕捉
    skillTable = Catch;
    skillShowKind =  ECastchStyle.HandFail;
  elseif Contains(skillId, 15002, 15004) then    --捕網
    skillTable = Catch;
    skillShowKind = ECastchStyle.NetFail;
  elseif Contains(skillId, 15003, 15005) then    --捕捉成功
    skillTable = Catch;
    skillShowKind = ECastchStyle.NetSuccess;
  elseif skillId == 16001 then  --箭樓射箭
    skillTable = ArrowTower;
  elseif skillId == 16002 then  --鉅鹿外城門 鉅鹿主城門
    skillTable = CityWall;
  elseif skillId == 18002 then  --逃跑失敗
    skillTable = ExitFail;
  elseif skillId == 19001 then  --使用輔助物品
    skillTable = UseItem;
  elseif skillId == 20001 then  --樹精損血
    skillTable = ClumpAtk; 
  elseif skillId == 20003 or skillId == 14055 then --傷害反彈
    skillTable = MirrorAtk;
  elseif skillId == 20004 then  --衰神附身
    skillTable = Poor;
  elseif skillId == 20005 then  --福神附身
    skillTable = God;
  elseif skillId == 20006 then  --護主
    skillTable = Protect;
  elseif skillId == 20007 then  --解除護主
    skillTable = DisProtect; 
  elseif skillId == 20008 then 
    skillTable = Spell;
  elseif skillId == 20009 then  --衝車
    skillTable = DashCar;
  elseif skillId == 20010 then  --刀車
    skillTable = KnifeCar;
  elseif skillId == 20011 then  --弩車
    skillTable = BoltCar;
    --[[
And these two had a dream on the same night; the chief wine-servant and the chief bread-maker of the king of Egypt, who were in prison, the two of them had dreams with a special sense.
And in the morning when Joseph came to them he saw that they were looking sad.
And he said to the servants of Pharaoh who were in prison with him, Why are you looking so sad?
Then they said to him, We have had a dream, and no one is able to give us the sense. And Joseph said, Does not the sense of dreams come from God? what was your dream?
Then the chief wine-servant gave Joseph an account of his dream, and said, In my dream I saw a vine before me;
And on the vine were three branches; and it seemed as if it put out buds and flowers, and from them came grapes ready for cutting.
And Pharaoh's cup was in my hand, and I took the grapes and crushing them into Pharaoh's cup, gave the cup into Pharaoh's hand.
Then Joseph said, This is the sense of your dream: the three branches are three days;
After three days Pharaoh will give you honour, and put you back into your place, and you will give him his cup as you did before, when you were his wine-servant.
But keep me in mind when things go well for you, and be good to me and say a good word for me to Pharaoh and get me out of this prison:
For truly I was taken by force from the land of the Hebrews; and I have done nothing for which I might be put in prison.
Now when the chief bread-maker saw that the first dream had a good sense, he said to Joseph, I had a dream; and in my dream there were three baskets of white bread on my head;
And in the top basket were all sorts of cooked meats for Pharaoh; and the birds were taking them out of the baskets on my head.
Then Joseph said, This is the sense of your dream: the three baskets are three days;
--]]
  elseif skillId == 20012 then  --投石車
    skillTable = ThrowCar;
  elseif skillId == 20013 then  --井闌
    skillTable = ArrowTower;
  elseif Contains(skillId, 20014, 20055) then  --四人& 兩人混亂
    skillTable = Chaos4;
  elseif skillId == 20016 then  --龍頭
    skillTable = DragonHead;
  elseif skillId == 20017 then  --右龍爪
    skillTable = SweepClaw; 
  elseif skillId == 20018 then  --左龍爪
    skillTable = LeftClaw; 
  elseif skillId == 20019 then  --六人狀解(玄武)
    skillTable = TurtleDis6Status; 
  elseif skillId == 20020 then  --三龜必殺
    skillTable = TurtleCast;
  elseif skillId == 20021 then  --龜掌亂拍(右手)
    skillTable = TurtleRHand;
  elseif skillId == 20022 then  --龜速(左手)
    skillTable = TurtleLHand;
  elseif skillId == 20023 then  --龜毒
    skillTable = TurtlePoison;
  elseif skillId == 20024 then  --龜元氣（十人元氣）
    skillTable = TurtleVitality;
  elseif skillId == 20025 or skillId == 20049 then  --三人樹精、超級樹精
    skillTable = Clump3;
  elseif skillId == 20026 then  --三人冰封
    skillTable = IceBound3;
  elseif skillId == 20027 or skillId == 20048 then  --三人旋風
    skillTable = WhirlWind3;
  elseif skillId == 20028 then  --三人暴風
    skillTable = Gale3;
  elseif skillId == 20029 then  --白虎粒子砲
    skillTable = TigerCast;  
  elseif skillId == 20033 then  --絕望之劍
    skillTable = SwordBreath;
  elseif skillId == 20034 then   --牛頭衝車
    skillTable = CowDashCar; 
  elseif skillId == 20035 then   --精鋼刀車
    skillTable = SteelKnifeCar; 
  elseif skillId == 20036 then   --連弩車
    skillTable = RepeatBoltCar;
  elseif skillId == 20037 then   --投石巨車
    skillTable = BigThrowCar; 
  elseif skillId == 20038 then   --強弓井欄
    skillTable = StrongArrowTower; 
  elseif skillId == 20039 then   --神箭塔
    skillTable = GodArrowTower; 
  elseif skillId == 20040 then   --石牆
    skillTable = RockWall;
    --[[
And these two had a dream on the same night; the chief wine-servant and the chief bread-maker of the king of Egypt, who were in prison, the two of them had dreams with a special sense.
And in the morning when Joseph came to them he saw that they were looking sad.
And he said to the servants of Pharaoh who were in prison with him, Why are you looking so sad?
Then they said to him, We have had a dream, and no one is able to give us the sense. And Joseph said, Does not the sense of dreams come from God? what was your dream?
Then the chief wine-servant gave Joseph an account of his dream, and said, In my dream I saw a vine before me;
And on the vine were three branches; and it seemed as if it put out buds and flowers, and from them came grapes ready for cutting.
And Pharaoh's cup was in my hand, and I took the grapes and crushing them into Pharaoh's cup, gave the cup into Pharaoh's hand.
Then Joseph said, This is the sense of your dream: the three branches are three days;
After three days Pharaoh will give you honour, and put you back into your place, and you will give him his cup as you did before, when you were his wine-servant.
But keep me in mind when things go well for you, and be good to me and say a good word for me to Pharaoh and get me out of this prison:
For truly I was taken by force from the land of the Hebrews; and I have done nothing for which I might be put in prison.
Now when the chief bread-maker saw that the first dream had a good sense, he said to Joseph, I had a dream; and in my dream there were three baskets of white bread on my head;
And in the top basket were all sorts of cooked meats for Pharaoh; and the birds were taking them out of the baskets on my head.
Then Joseph said, This is the sense of your dream: the three baskets are three days;
--]]
  elseif skillId == 20041 then   --竹牆
    skillTable = BambooWall; 
  elseif skillId == 20042 then   --磚牆
    skillTable = BrickWall; 
  elseif skillId == 20043 then   --巨石陷阱
    skillTable = BigRollStone; 
  elseif skillId == 20044 then   --爆破
    skillTable = Explode; 
  elseif skillId == 20045 then   --神怒天誅
    skillTable = Wrath; 
  elseif skillId == 20046 then  --退敵術
    skillTable = OutEnemy;
  elseif skillId == 20047 then  --強效施毒
    skillTable = SuperPoision;
  elseif skillId == 20051 then --九尾狐魅惑
    skillTable = SKILL20051;
  elseif skillId == 20052 then --炎爆
    skillTable = FireBlast;
  elseif skillId == 20053 then --雷擊
  
  
    --[[
   And these two had a dream on the same night; the chief wine-servant and the chief bread-maker of the king of Egypt, who were in prison, the two of them had dreams with a special sense.
   And in the morning when Joseph came to them he saw that they were looking sad.
   And he said to the servants of Pharaoh who were in prison with him, Why are you looking so sad?
   Then they said to him, We have had a dream, and no one is able to give us the sense. And Joseph said, Does not the sense of dreams come from God? what was your dream?
   Then the chief wine-servant gave Joseph an account of his dream, and said, In my dream I saw a vine before me;
   And on the vine were three branches; and it seemed as if it put out buds and flowers, and from them came grapes ready for cutting.
   And Pharaoh's cup was in my hand, and I took the grapes and crushing them into Pharaoh's cup, gave the cup into Pharaoh's hand.
   Then Joseph said, This is the sense of your dream: the three branches are three days;
   After three days Pharaoh will give you honour, and put you back into your place, and you will give him his cup as you did before, when you were his wine-servant.
   But keep me in mind when things go well for you, and be good to me and say a good word for me to Pharaoh and get me out of this prison:
   For truly I was taken by force from the land of the Hebrews; and I have done nothing for which I might be put in prison.
   Now when the chief bread-maker saw that the first dream had a good sense, he said to Joseph, I had a dream; and in my dream there were three baskets of white bread on my head;
   And in the top basket were all sorts of cooked meats for Pharaoh; and the birds were taking them out of the baskets on my head.
   Then Joseph said, This is the sense of your dream: the three baskets are three days;
   --]]
    skillTable = Lightning;
  elseif skillId == 20054 then --六人狀解
    skillTable = Dis6Status;
  elseif skillId == 20056 then  --哥吉拉肥胖光線
    skillTable = GodzillaBeam;
  elseif skillId == 20057 then  --哥吉拉胖獸神拳
    skillTable = GodzillaPunch;
  elseif skillId == 20058 then  --哥吉拉胖獸剁地
    skillTable = GodzillaEarthquake;
  elseif Contains(skillId, 21001, 14097) then  --震地槌, 震地槌卡
    skillTable = ShakeMallet;
  elseif skillId == 21002 then  --寒冰貫
    skillTable = ColdAdularia;
  elseif skillId == 21003 then  --紅蓮業火
    skillTable = RedlotusFire;
  elseif skillId == 21004 then  --破空閃
    skillTable = RuptureSky;
  elseif skillId == 21005 then  --猛牛襲
    skillTable = ViolentCattle;
  elseif skillId == 21006 then  --冰牙刃
    skillTable = ThreeSidesIceSwords;
  elseif skillId == 21007 then  --炙燄怒
    skillTable = RoastFlame;
  elseif skillId == 21008 then  --魅毒風
    skillTable = BiteSpiritPoisonous;
    skillShowKind = ESkill_Kind.BiteSpiritPoisonous;
  elseif skillId == 21009 then  --殞星落
    skillTable = Meteor;
  elseif skillId == 21010 then  --孫家獨門重拳
    skillTable = BoxingOfSun;
  elseif skillId == 21011 then  --火凰殞天
    skillTable = PhoenixRabid;
  elseif skillId == 21012 then  --回馬槍
    skillTable = BackThrust;
  elseif skillId == 21013 then  --獅咬
    skillTable = LionSnap;
  elseif skillId == 21014 then  --火鐮
    skillTable = FireSickle;
  elseif skillId == 21015 then  --洸閃二段式
    skillTable = BravelyTwoGradation;
  elseif skillId == 21016 then  --風動痕
    skillTable = WindMove;
    skillShowKind = ESkill_Kind.WindMove;
  elseif skillId == 21017 then  --刀劍淵獄
    skillTable = SwordHell;
  elseif skillId == 21018 then  --炎刃斬
    skillTable = KurningSword;
  elseif skillId == 21019 then  --黃忠弓
    skillTable = BigBow; 
  elseif skillId == 21020 then  --闇黑黃咒
    skillTable = DarkIncantation;
  elseif skillId == 21021 then  --黃巾怒濤
    skillTable = YellowScarfViolentWave;
  elseif skillId == 21022 then  --黃巾之怒
    skillTable = YellowScarfAnger;
  elseif skillId == 21023 then  --蒼天已死黃天當立(張角、張寶、張梁合體技)
    skillTable = HeavenDeadYellowSupersed;
  elseif skillId == 21024 then  --關羽特有技
    skillTable = ColdGorgeous; 
  elseif skillId == 21025 then  --張飛    狂蛇奪首
    skillTable = SnakeEight; 
  elseif skillId == 21026 then  --劉備    仁者無敵(強化技)
    skillTable = PitySoldier; 
  elseif skillId == 21027 then  --劉關張  桃園結義
    skillTable = PeachJust;
  elseif skillId == 21028 then  --劉備    仁者無敵(攻擊技)
    skillTable = BeneAchillean;
  elseif skillId == 21029 then  --甄宓    洛水凝息
    skillTable = MagicSwordWater;
    skillShowKind = ESkill_Kind.MagicSwordWater;
  elseif skillId == 21030 then  --楊修    岩葉飄劍破
    skillTable = MagicSwordEarth;
  elseif skillId == 21031 then   --飛燄亂劍
  
    --[[
And these two had a dream on the same night; the chief wine-servant and the chief bread-maker of the king of Egypt, who were in prison, the two of them had dreams with a special sense.
And in the morning when Joseph came to them he saw that they were looking sad.
And he said to the servants of Pharaoh who were in prison with him, Why are you looking so sad?
Then they said to him, We have had a dream, and no one is able to give us the sense. And Joseph said, Does not the sense of dreams come from God? what was your dream?
Then the chief wine-servant gave Joseph an account of his dream, and said, In my dream I saw a vine before me;
And on the vine were three branches; and it seemed as if it put out buds and flowers, and from them came grapes ready for cutting.
And Pharaoh's cup was in my hand, and I took the grapes and crushing them into Pharaoh's cup, gave the cup into Pharaoh's hand.
Then Joseph said, This is the sense of your dream: the three branches are three days;
After three days Pharaoh will give you honour, and put you back into your place, and you will give him his cup as you did before, when you were his wine-servant.
But keep me in mind when things go well for you, and be good to me and say a good word for me to Pharaoh and get me out of this prison:
For truly I was taken by force from the land of the Hebrews; and I have done nothing for which I might be put in prison.
Now when the chief bread-maker saw that the first dream had a good sense, he said to Joseph, I had a dream; and in my dream there were three baskets of white bread on my head;
And in the top basket were all sorts of cooked meats for Pharaoh; and the birds were taking them out of the baskets on my head.
Then Joseph said, This is the sense of your dream: the three baskets are three days;
--]]
    skillTable = FlyFireRandom;    
  elseif skillId == 21032 then --薑是老的辣
    skillTable = HotGinger;
  elseif skillId == 21033 then --前後暈擊
    skillTable = DizzyAtkDouble;
  elseif skillId == 21034 then --冰槌術
    skillTable = IceHammer;
  elseif skillId == 21035 then  --天火鐮斬
    skillTable = SkyFireSickle;
  elseif skillId == 21036 then  --天火術
    skillTable = SkyFlame;
  elseif skillId == 21037 then  --海豚守衛
    skillTable = DolphinGraud;
  elseif skillId == 21038 then  --魔龍偃月斬
    skillTable = DarkDragonCrescentSlash;
  elseif skillId == 21039 then  --帝王纏繞
    skillTable = EmperorSeize;
  elseif skillId == 21040 then  --背水一戰
    skillTable = LastLand;
  elseif skillId == 21041 then  --霸王無雙斬
    skillTable = OverlordSlash;
  elseif skillId == 21042 then  --諸葛狂龍咒
    skillTable = CrazyDragonSpell;
  elseif skillId == 21043 then  --偷渡伏擊
    skillTable = Ambush;
  elseif skillId == 22001 then  --光矛術
    skillTable = Arrow;
    skillShowKind = ESkill_Kind.LightArrow;
  elseif skillId == 22002 or skillId == 22020 then  --佛光掌
    skillTable = LightHand;
  elseif skillId == 22003 or skillId == 22019 then  --眩光
    skillTable = Glare;
  elseif skillId == 22004 or skillId == 22018 then  --烈焰之光, 真‧烈焰之光
    skillTable = LightFlames;
  elseif skillId == 22005 then  --光癒術
    skillTable = LightDisStatus;
  elseif skillId == 22006 then  --光之鏡
    skillTable = LightShield;
  elseif skillId == 22007 then  --光泉灌注
    skillTable = LightHealth;
  elseif skillId == 22009 then  --光速投擲
    skillTable = LightThrow;
  elseif Contains(skillId, 22010, 14096) then  --金幣攻擊, 金幣攻擊卡
    skillTable = GoldAttack;
  elseif skillId == 22011 then  --小白虎招喚
    skillTable = WTiger3;
  elseif skillId == 22012 then  --小中白虎招喚
    skillTable = WTiger2;
  elseif skillId == 22013 then  --中白虎招喚
    skillTable = WTiger2;
  elseif skillId == 22014 then  --大白虎招喚
    skillTable = WTiger1;
  elseif skillId == 22015 then  --集束光彈
    skillTable = Cluster;
  elseif skillId == 22016 or skillId == 22017 then  --瞳光之絆, 真‧瞳光之絆
    skillTable = SightCaptivity;
  elseif skillId == 22021 then --超光波
    skillTable = SKILL22021;
  elseif skillId == 22022 then --權傾萬里
    skillTable = SKILL22022;
  elseif skillId == 22025 then --清流水龍捲
    skillTable = Waterspout;
  elseif skillId == 22030 then --雌雄流星斬
    skillTable = Doom;
    skillShowKind = ESkill_Kind.StarDoom;
  elseif skillId == 22031 then  --魔王領域
    skillTable = GroupImmunityShield;
  elseif skillId == 22032 then  --瞬詠穿心
    skillTable = CrossingBlinkArrow;
    skillShowKind = ESkill_Kind.CrossingSongArrow;
  elseif skillId == 22040 then     --青龍皓月
    skillTable = LightDragon;
    skillShowKind = ESkill_Kind.LightDragon;
  elseif skillId == 22041 then     --俺乃張翼德(大喝)
    skillTable = LoudShout;
    skillShowKind = ESkill_Kind.ZhangFeiLoudShout;
  elseif skillId == 22042 then
    skillTable = SKILL22042;
  elseif skillId == 22043 then  --憶母狂雷
    skillTable = YiMuLightning;
  elseif skillId == 22044 then  --冰晶守護
    skillTable = IceWall;
    skillShowKind = ESkill_Kind.IceCrystalsShield;
  elseif skillId == 22046 then  --偶像光環
    skillTable = IdelHalo;
  elseif skillId == 23001 or skillId == 23017 or skillId == 23025 then  --闇毒箭, 真‧闇毒箭, 黑暗箭
    skillTable = Arrow;
    skillShowKind = ESkill_Kind.DarkArrow;
  elseif skillId == 22024 then --太傅靈光鏡
    skillTable = TaiFuSoulMirror;
  elseif skillId == 22026 then --霸氣烈刃
    skillTable = WindMove;
    skillShowKind = ESkill_Kind.KingWindMove;
  elseif skillId == 22027 then  --羅煞彎刀
    skillTable = IceCircularSaw;
    skillShowKind = ESkill_Kind.RoshaMachete;
  elseif skillId == 23002 or skillId == 23021 or skillId == 23026 then  --闇刃斬 、真闇刃斬, 暗魂斬
    skillTable = DarkCut;
  elseif skillId == 23003 then  --黑旋斬
    skillTable = BlackRotaryCut;
  elseif skillId == 23004 or skillId == 23018 then  --巫毒, 真‧巫毒
    skillTable = Voodoo;
  elseif skillId == 23005 then  --袖裡箭
    skillTable = SwordSleeve;
  elseif skillId == 23006 then  --骷髏投擲
    skillTable = ThrowSkull;
  elseif skillId == 23007 then  --巫毒娃娃
    skillTable = VoodooDoll;
  elseif skillId == 23008 then  --妖術激化
    skillTable = Witchcraft;
  elseif skillId == 23009 or skillId == 23022 then  --迷惑毒針, 真‧迷惑毒針
    skillTable = Lethal;
  elseif skillId == 23010 or skillId == 23020 then  --毒飛輪
    skillTable = FlyWheel;
  elseif skillId == 23011 then  --小玄武招喚
    skillTable = Basaltic3;
  elseif skillId == 23012 then  --小中玄武招喚
    skillTable = Basaltic2;
  elseif skillId == 23013 then  --中玄武招喚
    skillTable = Basaltic2;
  elseif skillId == 23014 then  --大玄武招喚
    skillTable = Basaltic1;
  elseif skillId == 23015 then  --暈斬
    skillTable = DizzyCut;
  elseif skillId == 23016 then  --闇黑連斬
    skillTable = DarknessBehead;
  elseif skillId == 23019 then  --萬毒穿心 Alen 20160303
    skillTable = DarkFire;
  elseif skillId == 23023 then --飄飄流風
    skillTable = MagicSwordWater;
    skillShowKind = ESkill_Kind.FloatWind;
  elseif skillId == 23024 then  --專武黑旋斬
    skillTable = EW_BlackRotaryCut;
  elseif skillId == 23027 then  --專武暈斬
    skillTable = EW_DizzyCut;
  elseif Contains(skillId, 20015, 20050) then  --四人狀解 
    skillTable = Dis4Status; 
  else                 
    skillTable = HandFight; 
  end
  if skillTable == nil then 
    logError("skillId"..skillId.." fail to get skillTable")
    return nil;
  else
    return Attack.CreateNewFuncion(skillTable, skillShowKind);
  end
end

function Attack.EndOfLine21()
  if LuaHelper.CheckDefine("DemoCode") then
    local people = 10;
    local gov = 2;
    
    for i = 1, gov do
      people  = people - i * 10
    end
    
    if people > 0 then
      return true
    else
      return false
    end
  end
end

function Attack.EndOfLine22()
  if LuaHelper.CheckDefine("DemoCode") then
    local people = 10;
    local gov = 2;
    
    for i = 1, gov do
      people  = people - i * 10
    end
    
    if people > 0 then
      return true
    else
      return false
    end
  end
end

function Attack.CreateNewFuncion(skillTable, showKind)
  return function(humIdx, targetIdx, fightArea)
    return skillTable.New(humIdx, targetIdx, fightArea, showKind)
  end;
end

function Attack:Update()
  if FightField.fightHum[self.humIdx] == nil then
    return false;
  end
  
  if self:CheckSkill() then
    self:CloseSkill();
    return false;
  end
  
  if self.nowSkill ~= nil then
    if self.nowSkill.tarIdx ~= nil and FightField.fightHum[self.nowSkill.tarIdx] == nil then
      return false;
    end
    self.nowSkill:Update(); --技能邏輯
  end
  return true;
end

function Attack.EndOfLine23()
  if LuaHelper.CheckDefine("DemoCode") then
    local people = 10;
    local gov = 2;
    
    for i = 1, gov do
      people  = people - i * 10
    end
    
    if people > 0 then
      return true
    else
      return false
    end
  end
end

function Attack.EndOfLine24()
  if LuaHelper.CheckDefine("DemoCode") then
    local people = 10;
    local gov = 2;
    
    for i = 1, gov do
      people  = people - i * 10
    end
    
    if people > 0 then
      return true
    else
      return false
    end
  end
end

function Attack.EndOfLine25()
  if LuaHelper.CheckDefine("DemoCode") then
    local people = 10;
    local gov = 2;
    
    for i = 1, gov do
      people  = people - i * 10
    end
    
    if people > 0 then
      return true
    else
      return false
    end
  end
end

function Attack:SetLight(index, aId, interval, aStartPage, aEndPage, allPage, aTracer_Style, fromX, fromY,
                         alpha, circle, biasY, aObjX, aObjY, aSpeed, aCurvekind, parameter)
  if alpha == nil then
    alpha =255;
  end
  if circle == nil then
    circle  =true;
  end
  if biasY == nil then
    biasY =0;
  end
  if aObjX == nil then
    aObjX =0;
  end
  if aObjY == nil then
    aObjY =0;
  end
  if aSpeed == nil then
    aSpeed =0.36;
  end
  if aCurvekind == nil then
    aCurvekind =1
  end
  
  self:StopLight(index);
  
  if Setting.client.DisplayMode == 3 then
    aId = 10000;
    interval = 40;
    aStartPage = 1;
    aEndPage = 1;
    allPage = 4;
  end
  
  if type(biasY) == "boolean" then
    local second = alpha;
    self.lights[index] = EffectLight.New(aId, interval, aStartPage, aEndPage, allPage, aTracer_Style, fromX, fromY,circle, biasY, aObjX, aObjY, aSpeed, aCurvekind, parameter, nil, FightField.timeScale);
    self:SetLiveTime(index, second);
  else
    self.lights[index] = EffectLight.New(aId, interval, aStartPage, aEndPage, allPage, aTracer_Style, fromX, fromY,alpha, circle, biasY, aObjX, aObjY, aSpeed, aCurvekind, nil, FightField.timeScale);
  end
  
  
  local order = 0;
  if Contains(index, EEffectLightKind.Ground) then
    order = FightField.FIGHT_GROUND_ORDER;
  elseif Contains(index, EEffectLightKind.Body1, EEffectLightKind.Body2, EEffectLightKind.Shoot) then
    order = FightField.FIGHT_BODYLIGHT_ORDER;
  elseif Contains(index, EEffectLightKind.None) then
    order = 0;
  else
    order = FightField.FIGHT_SKY_ORDER
  end
  
  self.lights[index]:SetSortingOrder(order)
end

function Attack.EndOfLine26()
  if LuaHelper.CheckDefine("DemoCode") then
    local people = 10;
    local gov = 2;
    
    for i = 1, gov do
      people  = people - i * 10
    end
    
    if people > 0 then
      return true
    else
      return false
    end
  end
end

function Attack.EndOfLine27()
  if LuaHelper.CheckDefine("DemoCode") then
    local people = 10;
    local gov = 2;
    
    for i = 1, gov do
      people  = people - i * 10
    end
    
    if people > 0 then
      return true
    else
      return false
    end
  end
end

function Attack:SetLightWithOrder(index, aDisplay, aId, interval, aStartPage, aEndPage, allPage, aTracer_Style, fromX, fromY,
                                  alpha, circle, biasY, aObjX, aObjY, aSpeed, aCurvekind, parameter)
  
  if alpha == nil then
    alpha =255;
  end
  if circle == nil then
    circle  =true;
  end
  if biasY == nil then
    biasY =0;
  end
  if aObjX == nil then
    aObjX =0;
  end
  if aObjY == nil then
    aObjY =0;
  end
  if aSpeed == nil then
    aSpeed =0.36;
  end
  if aCurvekind == nil then
    aCurvekind =1
  end
  
  self.showKind = 2;
  self.disKind[index] = aDisplay;
  
  self:StopLight(index);
  
  if Setting.client.DisplayMode == 3 then
    aId = 10000;
    interval = 40;
    aStartPage = 1;
    aEndPage = 1;
    allPage = 4;
  end;
  
  if type(biasY) == "boolean" then
    local second = alpha;
    self.lights[index] = EffectLight.New(aId, interval, aStartPage, aEndPage, allPage, aTracer_Style, fromX, fromY,circle, biasY, aObjX, aObjY, aSpeed, aCurvekind, parameter, nil, FightField.timeScale);
    self:SetLiveTime(index, second);
  else
    self.lights[index] = EffectLight.New(aId, interval, aStartPage, aEndPage, allPage, aTracer_Style, fromX, fromY,alpha, circle, biasY, aObjX, aObjY, aSpeed, aCurvekind, nil, FightField.timeScale);
  end
  
  local order = 0;
  if self.disKind[index] == EEffectLightDis.Ground then
    order = FightField.FIGHT_GROUND_ORDER;
  elseif self.disKind[index] == EEffectLightDis.Body then
    order = FightField.FIGHT_BODYLIGHT_ORDER;
  elseif self.disKind[index] == EEffectLightDis.None then
    order = 0;
  else
    order = FightField.FIGHT_SKY_ORDER;
  end
  
  self.lights[index]:SetSortingOrder(order)
end

function Attack:SetLiveTime(index, second)
  if self.lights[index] == nil then
    return;
  end
  local effectLight = self.lights[index];
  if (effectLight.targetPos.x ~= 0 and effectLight.targetPos.y ~= 0) then
    local dist = (effectLight.showPos - effectLight.targetPos).magnitude;
    effectLight.lightSpeed = dist / second;
  end
end

function Attack:StopLight(index)
  local effectLight = self.lights[index];
  if effectLight == nil then
    return;
  end
  
  effectLight.picId = 0;
  effectLight.orderCount = 0;
  effectLight.arrive = false;
end

function Attack:StopAllLight()
  if self.nowSkill ~= nil and self.nowSkill.ExtraClose ~= nil then
    self.nowSkill:ExtraClose();
  end
  
  for k, v in pairs(self.lights) do
    self:StopLight(k);
  end
end

function Attack.EndOfLine28()
  if LuaHelper.CheckDefine("DemoCode") then
    local people = 10;
    local gov = 2;
    
    for i = 1, gov do
      people  = people - i * 10
    end
    
    if people > 0 then
      return true
    else
      return false
    end
  end
end

function Attack.EndOfLine29()
  if LuaHelper.CheckDefine("DemoCode") then
    local people = 10;
    local gov = 2;
    
    for i = 1, gov do
      people  = people - i * 10
    end
    
    if people > 0 then
      return true
    else
      return false
    end
  end
end

function Attack:CheckLightIsEnd(index)
  local effectLight = self.lights[index];
  if effectLight == nil then
    return true;
  end
  
  return effectLight.picId == 0;
end


--技能演出用腳色
AttackRole = {};
AttackRole.__index = AttackRole;

AttackRole.roleActions = {
  ERolePose.Walk,
  ERolePose.Stand,
  ERolePose.Prepare,
  ERolePose.Jump,
  ERolePose.Attack,
  ERolePose.Magic,
};

function AttackRole.New(skillKind, kind, npcId)
  local self = {};
  setmetatable(self, AttackRole);
  
  self.roleController = Role.CreateRole(kind, 0);
  self.roleController.npcId = npcId;
  self.roleController.actions = AttackRole.roleActions;
  self.roleController:Initialize();
  self.roleController.transform:SetParent(FightField.fightRoot.transform);
  self.roleController.transform.localPosition = Vector3.zero;
  self.roleController.transform.localScale = Vector3.one;
  self.roleController.hudObject:SetActive(false);
  
  self.nowPos = Vector2.zero;
  self.goal = Vector2.zero;
  self.moveOldTime = CGTimer.time;
  self.arrive = false;
  self.jumpStart = false;
  self.totalDist = 0;
  self:SetPosition();
  self.speed = 0.54;
  return self;
end

function AttackRole.AviodCov()
  if LuaHelper.CheckDefine("DemoCode") then
    local selfBo = 0
    local other = {10, 20 , 30}
    for _,v in ipairs(other) do
      if (v - selfBo) > 10 then
        return true;
      else
        return false;
      end
    end
  end
end

function AttackRole.AviodCov1()
  if LuaHelper.CheckDefine("DemoCode") then
    local selfBo = 0
    local other = {10, 20 , 30}
    for _,v in ipairs(other) do
      if (v - selfBo) > 10 then
        return true;
      else
        return false;
      end
    end
  end
end

function AttackRole:SetVisible(visible)
  self.roleController:SetVisible(visible);
  self.roleController.hudObject:SetActive(false);
end

function AttackRole:Free()
  self.roleController.hudObject:SetActive(true);
  self.roleController:Destroy();
end

function AttackRole:Update()
  self.roleController:UpdateShow(false, FightField.timeScale);
end

function AttackRole:SetPosition()
  self.roleController:SetPosition(self.nowPos)
  self.roleController.canvas.sortingOrder = FightField.FIGHT_BODY_ORDER  + self.nowPos.y;
end

function AttackRole:UpdateJumpPos()
  local nowDist = 0
  -- 現在距離
  
  if self.jumpStart == true then
    nowDist =(self.goal - self.nowPos).magnitude;
    self.jumpHeight = math.round(360 *(0.5 - math.abs((nowDist /(self.totalDist + 0.001)) -0.5)));
    self.jumpHeight = math.round(self.jumpHeight - 0.003 * math.pow(self.jumpHeight, 2));
    self.nowPos = Vector2.New(self.nowPos.x, self.nowPos.y - self.jumpHeight);
  end
end

function AttackRole:SetSpeed(sp)
  self.speed = sp;
end

function AttackRole.AviodCov2()
  if LuaHelper.CheckDefine("DemoCode") then
    local selfBo = 0
    local other = {10, 20 , 30}
    for _,v in ipairs(other) do
      if (v - selfBo) > 10 then
        return true;
      else
        return false;
      end
    end
  end
end

function AttackRole.AviodCov3()
  if LuaHelper.CheckDefine("DemoCode") then
    local selfBo = 0
    local other = {10, 20 , 30}
    for _,v in ipairs(other) do
      if (v - selfBo) > 10 then
        return true;
      else
        return false;
      end
    end
  end
end

function AttackRole.AviodCov4()
  if LuaHelper.CheckDefine("DemoCode") then
    local selfBo = 0
    local other = {10, 20 , 30}
    for _,v in ipairs(other) do
      if (v - selfBo) > 10 then
        return true;
      else
        return false;
      end
    end
  end
end

function AttackRole:GetPosition(speed)
  if speed == nil then
    speed = self.speed;
  end
  
  local dTime = CGTimer.time - self.moveOldTime;
  self.moveOldTime = CGTimer.time;
  local moveDist = math.round(dTime * speed * 1000 * FightField.timeScale);  --移動距離 
  local dx = self.goal.x - self.nowPos.x;
  local dy = self.goal.y - self.nowPos.y;
  
  if (math.abs(dx)<=moveDist) and (math.abs(dy)<=moveDist) then
    --    vx:=0;
    --    vy:=0;
    self.nowPos = Vector2.New(self.goal.x, self.goal.y);
    self.arrive = true;
    self.jumpStart = false;
    return;
  end
  
  self.arrive = false;
  local m = math.abs(dy/(dx+0.001));
  
  local den = 1/math.sqrt(math.pow(m, 2)+1)*moveDist;
  if dx>=0 then
    vx = math.round(den);
  else
    vx = -math.round(den);
  end
  if dy>=0 then
    vy = math.round(m*den);
  else
    vy = -math.round(m*den);
  end
  
  self.nowPos = Vector2.New(self.nowPos.x + vx, self.nowPos.y + vy);
  local tempPos = Vector2.New(self.nowPos.x, self.nowPos.y);
  self:UpdateJumpPos();
  self:SetPosition()
  self.nowPos = tempPos;
end

function AttackRole:SetScale(scale)
  local rectTrans = self.roleController.bodyObject.transform;
  rectTrans.localScale = scale;
end

function AttackRole.AviodCov5()
  if LuaHelper.CheckDefine("DemoCode") then
    local selfBo = 0
    local other = {10, 20 , 30}
    for _,v in ipairs(other) do
      if (v - selfBo) > 10 then
        return true;
      else
        return false;
      end
    end
  end
end

function AttackRole.AviodCov6()
  if LuaHelper.CheckDefine("DemoCode") then
    local selfBo = 0
    local other = {10, 20 , 30}
    for _,v in ipairs(other) do
      if (v - selfBo) > 10 then
        return true;
      else
        return false;
      end
    end
  end
end